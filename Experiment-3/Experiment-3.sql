-- Easy Problem

CREATE TABLE EMP (
	EMPID INT
);

INSERT INTO EMP VALUES
	(2),
	(4),
	(4),
	(6),
	(6),
	(7),
	(8),
	(8);

SELECT MAX(EMPID) FROM EMP 
WHERE EMPID NOT IN
	(SELECT * FROM EMP
	GROUP BY EMPID
	HAVING COUNT(EMPID) > 1)




--Medium Level Problem
CREATE TABLE department (
    id INT PRIMARY KEY,
    dept_name VARCHAR(50)
);


CREATE TABLE employee (
    id INT,
    name VARCHAR(50),
    salary INT,
    department_id INT,
    FOREIGN KEY (department_id) REFERENCES department(id)
);



INSERT INTO department (id, dept_name) VALUES
(1, 'IT'),
(2, 'SALES');


INSERT INTO employee (id, name, salary, department_id) VALUES
(1, 'JOE', 70000, 1),
(2, 'JIM', 90000, 1),
(3, 'HENRY', 80000, 2),
(4, 'SAM', 60000, 2),
(5, 'MAX', 90000, 1);

SELECT D.DEPT_NAME , E.NAME , E.SALARY , E.DEPARTMENT_ID
FROM EMPLOYEE AS E
INNER JOIN 
DEPARTMENT AS D
ON E.DEPARTMENT_ID = D.ID
WHERE E.SALARY IN 
    (
        SELECT MAX(E2.SALARY) 
        FROM EMPLOYEE AS E2
        WHERE E2.DEPARTMENT_ID = E.DEPARTMENT_ID
    )
ORDER BY D.DEPT_NAME


SELECT D.DEPT_NAME , E.NAME , E.SALARY , E.DEPARTMENT_ID
FROM EMPLOYEE AS E
INNER JOIN 
DEPARTMENT AS D
ON E.DEPARTMENT_ID = D.ID
WHERE E.SALARY IN 
    (
        SELECT MAX(E2.SALARY) 
        FROM EMPLOYEE AS E2
        GROUP BY E2.DEPARTMENT_ID
    )

--Hard Level Problem

CREATE TABLE TABLEA 
(
    EMPID INT PRIMARY KEY,
    ENAME VARCHAR(50),
    SALARY INT
);

CREATE TABLE TABLEB
(
    EMPID INT,
    ENAME VARCHAR(50),
    SALARY INT
    
);

INSERT INTO TABLEA (EMPID,ENAME,SALARY) VALUES 
    (1,'AA',1000),
    (2,'BB',300);

INSERT INTO TABLEB (EMPID,ENAME,SALARY) VALUES 
    (2,'BB',400),
    (3,'CC',100);

SELECT EMPID , MIN(ENAME) AS ENAME, MIN(SALARY) AS SALARY
FROM 
(
    SELECT * FROM TABLEA
    UNION ALL
    SELECT * FROM TABLEB
) AS INTERMEDIATE_RESULT
GROUP BY EMPID

SELECT EMPID , ENAME, MIN(SALARY) AS SALARY
FROM 
(
    SELECT * FROM TABLEA
    UNION ALL
    SELECT * FROM TABLEB
) AS INTERMEDIATE_RESULT
GROUP BY EMPID , ENAME



